<!doctype html>
<!-- SPDX-FileCopyrightText: 2026 Evan McKeown -->
<!-- SPDX-License-Identifier: Apache-2.0 -->

<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Score Tracker</title>
    <style>
      :root {
        color-scheme: light dark;
      }

      body {
        font-family: Arial, sans-serif;
        margin: 2rem auto;
        max-width: 760px;
        padding: 0 1rem;
      }

      h1 {
        margin-bottom: 0.5rem;
      }

      .row {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
        align-items: center;
      }

      .card {
        border: 1px solid #6666;
        border-radius: 10px;
        padding: 1rem;
        margin: 0.75rem 0;
      }

      input[type='text'],
      input[type='number'] {
        padding: 0.4rem 0.5rem;
      }

      button {
        cursor: pointer;
        padding: 0.4rem 0.6rem;
      }

      .flash {
        border-left: 4px solid #5b9;
        padding: 0.5rem 0.75rem;
        margin: 0.5rem 0;
        background: #5b91;
      }

      .score {
        font-size: 1.25rem;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <h1>Simple Score Tracker</h1>

    {% with messages = get_flashed_messages() %}
      {% if messages %}
        {% for message in messages %}
          <div class="flash">{{ message }}</div>
        {% endfor %}
      {% endif %}
    {% endwith %}

    {% if not game_started %}
      <section class="card">
        <h2>Setup game</h2>
        <p>Add all players and their starting score, then start the game.</p>
        <form class="row" method="post" action="{{ url_for('add_player') }}">
          <input type="text" name="name" placeholder="Player name" required />
          <input type="number" name="starting_score" value="0" step="1" required />
          <button type="submit">Add player</button>
        </form>
      </section>

      <section class="row" style="justify-content: space-between; margin-top: 1rem">
        <h2 style="margin: 0">Players</h2>
        <div class="row">
          <form method="post" action="{{ url_for('reset_scores') }}">
            <button type="submit">Reset all scores</button>
          </form>
          <form method="post" action="{{ url_for('start_game') }}">
            <button type="submit" {% if not players %}disabled{% endif %}>Start game</button>
          </form>
        </div>
      </section>

      {% if players %}
        {% for player in players %}
          <article class="card">
            <div class="row" style="justify-content: space-between">
              <div>
                <div><strong>{{ player.name }}</strong></div>
                <div class="score">{{ player.score }}</div>
              </div>

              <form method="post" action="{{ url_for('delete_player', player_id=player.id) }}">
                <button type="submit">Remove player</button>
              </form>
            </div>
          </article>
        {% endfor %}
      {% else %}
        <p>No players yet. Add players above.</p>
      {% endif %}
    {% else %}
      <section class="card">
        <h2>Game in progress</h2>
        {% if current_player %}
          <p>
            Current turn: <strong>{{ current_player.name }}</strong>
            (score: {{ current_player.score }})
          </p>
          <form class="row" method="post" action="{{ url_for('update_turn_score') }}">
            <input type="number" name="delta" value="1" step="1" required />
            <button type="submit">Apply and next turn</button>
          </form>
        {% else %}
          <p>No current player. End and restart the game.</p>
        {% endif %}
      </section>

      <section class="row" style="justify-content: space-between; margin-top: 1rem">
        <h2 style="margin: 0">Scoreboard</h2>
        <div class="row">
          <form method="post" action="{{ url_for('reset_scores') }}">
            <button type="submit">Reset all scores</button>
          </form>
          <form method="post" action="{{ url_for('end_game') }}">
            <button type="submit">End game</button>
          </form>
        </div>
      </section>

      {% for player in players %}
        <article class="card">
          <div class="row" style="justify-content: space-between">
            <div>
              <div>
                <strong>{{ player.name }}</strong>
                {% if current_player and current_player.id == player.id %}
                  <span>‚Üê current</span>
                {% endif %}
              </div>
              <div class="score">{{ player.score }}</div>
            </div>
          </div>
        </article>
      {% endfor %}
    {% endif %}
  </body>
</html>
