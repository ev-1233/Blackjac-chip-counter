#!/usr/bin/env bash
set -euo pipefail

mapfile -t staged_files < <(git diff --cached --name-only --diff-filter=ACMR)

if [[ ${#staged_files[@]} -eq 0 ]]; then
  exit 0
fi

python3 scripts/spdx_headers.py --apply "${staged_files[@]}"
python3 scripts/spdx_headers.py --check "${staged_files[@]}"

git add "${staged_files[@]}"
